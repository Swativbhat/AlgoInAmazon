<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Case Study-1</title>
    <link rel="icon" href="../images/icon.png" type="image/png" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"
    />

    <style>
      /*  import google fonts */
      @import url("https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&family=Ubuntu:wght@400;500;700&display=swap");

      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
        text-decoration: none;
        scroll-behavior: smooth;
      }
      body {
        font-family: "Poppins", sans-serif;
        margin: 0;
        padding: 0;
        background-color: #121212;
        color: #fff;
      }

      /* navbar styling  */
      .navbar {
        position: fixed;
        width: 100%;
        z-index: 999;
        padding: 30px 0;
        font-family: "Ubuntu", sans-serif;
        transition: all 0.3s ease;
        background-color: rgba(18, 18, 18, 0.9);
        backdrop-filter: blur(10px);
        /* margin-left: 100px; */
      }

      .navbar.sticky {
        padding: 15px 0;
        background: rgba(30, 30, 30, 0.95);
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
      }

      .navbar .max-width {
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 0 50px;
      }

      .navbar .logo a {
        color: #fff;
        font-size: 35px;
        font-weight: 600;
        letter-spacing: 1px;
        margin-left: 150px;
      }

      .navbar .logo a span {
        color: #bb86fc;
        transition: all 0.3s ease;
      }

      .navbar.sticky .logo a span {
        color: #bb86fc;
      }

      .navbar .menu li {
        list-style: none;
        display: inline-block;
      }

      .navbar .menu li a {
        display: block;
        color: #e0e0e0;
        font-size: 18px;
        font-weight: 500;
        margin-left: 25px;
        transition: color 0.3s ease;
        position: relative;
      }

      .navbar .menu li a:hover {
        color: #bb86fc;
      }

      .navbar .menu li a::after {
        content: "";
        position: absolute;
        width: 0;
        height: 2px;
        background: #bb86fc;
        bottom: -5px;
        left: 0;
        transition: width 0.3s ease;
      }

      .navbar .menu li a:hover::after {
        width: 100%;
      }

      .navbar.sticky .menu li a:hover {
        color: #bb86fc;
      }
      .case-study-container {
        max-width: 900px;
        margin: 0 auto 60px auto;
        padding: 160px 20px 0 20px; /* Top padding accounts for fixed navbar height */
      }

      .case-study-title {
        font-size: 32px;
        color: #bb86fc;
        margin-bottom: 20px;
        font-family: "Ubuntu", sans-serif;
        /* margin-left: 150px; */
      }

      .case-study-image {
        width: 100%;
        border-radius: 12px;
        margin-bottom: 30px;
      }

      .case-study-text {
        font-size: 18px;
        line-height: 1.8;
        color: #e0e0e0;
        margin-bottom: 25px;
      }

      .code-block {
        background-color: #1e1e1e;
        color: #d4d4d4;
        padding: 20px;
        border-radius: 10px;
        overflow-x: auto;
        font-family: monospace;
        font-size: 15px;
        margin-bottom: 30px;
      }

      .case-study-navigation {
        display: flex;
        justify-content: space-between;
        margin-bottom: 40px;
        margin-top: 40px;
      }

      .nav-link {
        color: #bb86fc;
        font-weight: 500;
        transition: color 0.3s ease;
      }

      .nav-link:hover {
        color: #ffffff;
      }

      .references {
        margin-top: 40px;
      }

      .reference-title {
        font-size: 20px;
        color: #bb86fc;
        margin-bottom: 10px;
      }

      .reference-list {
        list-style: disc;
        padding-left: 20px;
        color: #e0e0e0;
      }

      .reference-link {
        color: #bb86fc;
        text-decoration: underline;
      }

      .reference-link:hover {
        color: #ffffff;
      }
      .complexity-card {
        background-color: #1e1e1e;
        border-radius: 12px;
        padding: 20px;
        margin-bottom: 30px;
        box-shadow: 0 0 10px rgba(0, 0, 0, 0.3);
      }

      .card-title {
        font-size: 20px;
        color: #bb86fc;
        margin-bottom: 15px;
      }

      .complexity-table {
        width: 100%;
        border-collapse: collapse;
        color: #e0e0e0;
        font-size: 16px;
      }

      .complexity-table th,
      .complexity-table td {
        padding: 12px 15px;
        border: 1px solid #444;
        text-align: left;
      }

      .complexity-table th {
        background-color: #2a2a2a;
        color: #ffffff;
      }

      .complexity-table tr:nth-child(even) {
        background-color: #2e2e2e;
      }
    </style>
  </head>
  <body>
    <nav class="navbar">
      <div class="max-width">
        <div class="logo">
          <a href="#"><span>AlgoInAmazon</span></a>
        </div>
        <ul class="menu">
          <li><a href="../index.html" class="menu-btn">Home</a></li>
          <li>
            <a href="../domain/#case-studies-section" class="menu-btn"
              >Case studies</a
            >
          </li>
          <li><a href="../index.html#contact" class="menu-btn">Details</a></li>
        </ul>
        <div class="menu-btn">
          <i class="fas fa-bars"></i>
        </div>
      </div>
    </nav>

    <section id="case-studies-section" class="case-study-container">
      <h2 class="case-study-title">
        <i class="fas fa-briefcase"></i> Indexing New Products
      </h2>

      <h2 class="case-study-title">
        <i class="fas fa-check-circle"></i> 1.Long Structured Merge(LSM) Trees
      </h2>

      <p class="case-study-text">
        LSM trees can be used for indexing products by buffering writes in
        memory and flushing them to disk in sorted files. They support high
        write throughput and efficient range queries, making them ideal for
        dynamic product catalogs.
      </p>
      <img
        src="../images/case-1.jpg"
        alt="Case study visual"
        class="case-study-image"
      />

      <h2>Code:</h2>
      <pre class="code-block"><code>
#include &lt;iostream&gt;
#include &lt;fstream&gt;
#include &lt;map&gt;
#include &lt;vector&gt;
#include &lt;string&gt;
#include &lt;filesystem&gt;

class SSTable {
public:
    std::string filename;

    SSTable(const std::map&lt;std::string, std::string&gt;&amp; data, const std::string&amp; fname)
        : filename(fname) {
        std::ofstream file(filename);
        for (const auto&amp; pair : data) {
            file &lt;&lt; pair.first &lt;&lt; ":" &lt;&lt; pair.second &lt;&lt; "\n";
        }
    }

    std::string get(const std::string&amp; key) {
        std::ifstream file(filename);
        std::string line;
        while (getline(file, line)) {
            size_t sep = line.find(":");
            if (sep != std::string::npos) {
                std::string k = line.substr(0, sep);
                std::string v = line.substr(sep + 1);
                if (k == key) return v;
            }
        }
        return ""; // Not found
    }
};

class LSMTree {
    std::map&lt;std::string, std::string&gt; memTable;
    std::vector&lt;SSTable&gt; sstables;
    const size_t memTableLimit = 5;
    int sstableCounter = 0;

    void flushMemTableToSSTable() {
        std::string filename = "sstable_" + std::to_string(sstableCounter++) + ".txt";
        SSTable sstable(memTable, filename);
        sstables.push_back(sstable);
        memTable.clear();
    }

public:
    void put(const std::string&amp; key, const std::string&amp; value) {
        memTable[key] = value;
        if (memTable.size() &gt;= memTableLimit) {
            flushMemTableToSSTable();
        }
    }

    std::string get(const std::string&amp; key) {
        if (memTable.find(key) != memTable.end()) {
            return memTable[key];
        }

        // Search in SSTables from newest to oldest
        for (auto it = sstables.rbegin(); it != sstables.rend(); ++it) {
            std::string result = it-&gt;get(key);
            if (!result.empty()) return result;
        }

        return "Not Found";
    }
};

int main() {
    LSMTree tree;
    tree.put("apple", "red");
    tree.put("banana", "yellow");
    tree.put("cherry", "dark red");
    tree.put("date", "brown");
    tree.put("elderberry", "black");  // This will trigger flush
    tree.put("fig", "purple");

    std::cout &lt;&lt; "Get 'banana': " &lt;&lt; tree.get("banana") &lt;&lt; "\n";
    std::cout &lt;&lt; "Get 'fig': " &lt;&lt; tree.get("fig") &lt;&lt; "\n";
    std::cout &lt;&lt; "Get 'kiwi': " &lt;&lt; tree.get("kiwi") &lt;&lt; "\n";

    return 0;
}


  </code></pre>
      <div class="complexity-card">
        <h3 class="card-title">Time Complexity</h3>
        <table class="complexity-table">
          <thead>
            <tr>
              <th>Operation</th>
              <th>Complexity</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>Read time</td>
              <td>O(log(N))</td>
            </tr>
            <tr>
              <td>Write time</td>
              <td>O(1)</td>
            </tr>
            <tr>
              <td>Delete time</td>
              <td>O(log(N))</td>
            </tr>
          </tbody>
        </table>
      </div>

      <div class="references">
        <h4 class="reference-title">Key Inferences</h4>
        <ul class="reference-list">
          <li>
            LSM trees help shopping sites handle lots of updates when new
            products come in or prices change
          </li>
          <li>
            They keep searches fast, even when there are millions of items to
            sort through.
          </li>
        </ul>
      </div>

      <div class="references">
        <h3 class="reference-title">References</h3>
        <ul class="reference-list">
          <li>
            <a
              href="https://en.wikipedia.org/wiki/Log-structured_merge-tree"
              target="_blank"
              class="reference-link"
              >https://en.wikipedia.org/wiki/Log-structured_merge-tree</a
            >
          </li>
          <li>
            <a
              href="https://www.cs.umb.edu/~poneil/lsmtree.pdf"
              target="_blank"
              class="reference-link"
              >https://www.cs.umb.edu/~poneil/lsmtree.pdf</a
            >
          </li>
        </ul>
      </div>

      <div class="case-study-navigation">
        <a></a>
        <a href="case-2.html" class="nav-link">Next Case Study â†’</a>
      </div>
    </section>
  </body>
</html>
